package utils

import "math"

func Sgn(a float64) float64 {
	switch {
	case a < 0.0:
		return -1.0
	case a > 0:
		return +1.0
	}
	return 0.0
}

func Sigmoid(x float64) float64 {
	return 1.0 / (1.0 + math.Exp(-x))
}

func Identity(x float64) float64 {
	return x
}

func Exp(x float64) float64 {
	return math.Exp(x)
}

func SigmoidLinear(x float64) float64 {
	if x < -20.000000 {
		return 0.000000002061154
	}
	if (-20.000000000000000 <= x) && (x < -19.747474747474747) {
		return 0.000000002061154 + 0.000000002344762*x
	}
	if (-19.747474747474747 <= x) && (x < -19.494949494949495) {
		return 0.000000002653265 + 0.000000003018347*x
	}
	if (-19.494949494949495 <= x) && (x < -19.242424242424242) {
		return 0.000000003415474 + 0.000000003885434*x
	}
	if (-19.242424242424242 <= x) && (x < -18.989898989898990) {
		return 0.000000004396644 + 0.000000005001610*x
	}
	if (-18.989898989898990 <= x) && (x < -18.737373737373737) {
		return 0.000000005659677 + 0.000000006438432*x
	}
	if (-18.737373737373737 <= x) && (x < -18.484848484848484) {
		return 0.000000007285544 + 0.000000008288014*x
	}
	if (-18.484848484848484 <= x) && (x < -18.232323232323232) {
		return 0.000000009378477 + 0.000000010668928*x
	}
	if (-18.232323232323232 <= x) && (x < -17.979797979797979) {
		return 0.000000012072650 + 0.000000013733812*x
	}
	if (-17.979797979797979 <= x) && (x < -17.727272727272727) {
		return 0.000000015540785 + 0.000000017679152*x
	}
	if (-17.727272727272727 <= x) && (x < -17.474747474747474) {
		return 0.000000020005217 + 0.000000022757877*x
	}
	if (-17.474747474747474 <= x) && (x < -17.222222222222221) {
		return 0.000000025752156 + 0.000000029295577*x
	}
	if (-17.222222222222221 <= x) && (x < -16.969696969696969) {
		return 0.000000033150029 + 0.000000037711376*x
	}
	if (-16.969696969696969 <= x) && (x < -16.717171717171716) {
		return 0.000000042673103 + 0.000000048544797*x
	}
	if (-16.717171717171716 <= x) && (x < -16.464646464646464) {
		return 0.000000054931891 + 0.000000062490357*x
	}
	if (-16.464646464646464 <= x) && (x < -16.212121212121211) {
		return 0.000000070712284 + 0.000000080442084*x
	}
	if (-16.212121212121211 <= x) && (x < -15.959595959595958) {
		return 0.000000091025941 + 0.000000103550837*x
	}
	if (-15.959595959595958 <= x) && (x < -15.707070707070706) {
		return 0.000000117175143 + 0.000000133298086*x
	}
	if (-15.707070707070706 <= x) && (x < -15.454545454545453) {
		return 0.000000150836275 + 0.000000171590881*x
	}
	if (-15.454545454545453 <= x) && (x < -15.202020202020201) {
		return 0.000000194167306 + 0.000000220884115*x
	}
	if (-15.202020202020201 <= x) && (x < -14.949494949494948) {
		return 0.000000249946123 + 0.000000284337900*x
	}
	if (-14.949494949494948 <= x) && (x < -14.696969696969695) {
		return 0.000000321748623 + 0.000000366020158*x
	}
	if (-14.696969696969695 <= x) && (x < -14.444444444444443) {
		return 0.000000414177956 + 0.000000471167402*x
	}
	if (-14.444444444444443 <= x) && (x < -14.191919191919190) {
		return 0.000000533159623 + 0.000000606520441*x
	}
	if (-14.191919191919190 <= x) && (x < -13.939393939393939) {
		return 0.000000686321350 + 0.000000780756509*x
	}
	if (-13.939393939393939 <= x) && (x < -13.686868686868687) {
		return 0.000000883482085 + 0.000001005045541*x
	}
	if (-13.686868686868687 <= x) && (x < -13.434343434343434) {
		return 0.000001137281464 + 0.000001293766236*x
	}
	if (-13.434343434343434 <= x) && (x < -13.181818181818182) {
		return 0.000001463990109 + 0.000001665427809*x
	}
	if (-13.181818181818182 <= x) && (x < -12.929292929292929) {
		return 0.000001884552687 + 0.000002143856528*x
	}
	if (-12.929292929292929 <= x) && (x < -12.676767676767676) {
		return 0.000002425930599 + 0.000002759723069*x
	}
	if (-12.676767676767676 <= x) && (x < -12.424242424242424) {
		return 0.000003122830363 + 0.000003552508579*x
	}
	if (-12.424242424242424 <= x) && (x < -12.171717171717171) {
		return 0.000004019928489 + 0.000004573035449*x
	}
	if (-12.171717171717171 <= x) && (x < -11.919191919191919) {
		return 0.000005174735421 + 0.000005886724952*x
	}
	if (-11.919191919191919 <= x) && (x < -11.666666666666666) {
		return 0.000006661282126 + 0.000007577790452*x
	}
	if (-11.666666666666666 <= x) && (x < -11.414141414141413) {
		return 0.000008574865574 + 0.000009754634795*x
	}
	if (-11.414141414141413 <= x) && (x < -11.161616161616161) {
		return 0.000011038157189 + 0.000012556797519*x
	}
	if (-11.161616161616161 <= x) && (x < -10.909090909090908) {
		return 0.000014209065653 + 0.000016163896655*x
	}
	if (-10.909090909090908 <= x) && (x < -10.656565656565656) {
		return 0.000018290857738 + 0.000020807137355*x
	}
	if (-10.656565656565656 <= x) && (x < -10.404040404040403) {
		return 0.000023545185353 + 0.000026784123470*x
	}
	if (-10.404040404040403 <= x) && (x < -10.151515151515150) {
		return 0.000030308852896 + 0.000034477918856*x
	}
	if (-10.151515151515150 <= x) && (x < -9.898989898989898) {
		return 0.000039015398061 + 0.000044381575792*x
	}
	if (-9.898989898989898 <= x) && (x < -9.646464646464645) {
		return 0.000050222866696 + 0.000057129695382*x
	}
	if (-9.646464646464645 <= x) && (x < -9.393939393939393) {
		return 0.000064649557449 + 0.000073539030603*x
	}
	if (-9.393939393939393 <= x) && (x < -9.141414141414140) {
		return 0.000083220019722 + 0.000094660714080*x
	}
	if (-9.141414141414140 <= x) && (x < -8.888888888888888) {
		return 0.000107124240449 + 0.000121847424205*x
	}
	if (-8.888888888888888 <= x) && (x < -8.636363636363635) {
		return 0.000137893792016 + 0.000156839738128*x
	}
	if (-8.636363636363635 <= x) && (x < -8.383838383838382) {
		return 0.000177499786493 + 0.000201877112559*x
	}
	if (-8.383838383838382 <= x) && (x < -8.131313131313130) {
		return 0.000228478855321 + 0.000259840449867*x
	}
	if (-8.131313131313130 <= x) && (x < -7.878787878787879) {
		return 0.000294095130540 + 0.000334435128711*x
	}
	if (-7.878787878787879 <= x) && (x < -7.626262626262626) {
		return 0.000378548445871 + 0.000430425802030*x
	}
	if (-7.626262626262626 <= x) && (x < -7.373737373737374) {
		return 0.000487241830222 + 0.000553937301931*x
	}
	if (-7.373737373737374 <= x) && (x < -7.121212121212121) {
		return 0.000627124987276 + 0.000712839763185*x
	}
	if (-7.121212121212121 <= x) && (x < -6.868686868686869) {
		return 0.000807135028484 + 0.000917240707147*x
	}
	if (-6.868686868686869 <= x) && (x < -6.616161616161616) {
		return 0.001038761469683 + 0.001180112416929*x
	}
	if (-6.616161616161616 <= x) && (x < -6.363636363636363) {
		return 0.001336769655776 + 0.001518089520196*x
	}
	if (-6.363636363636363 <= x) && (x < -6.111111111111111) {
		return 0.001720125595219 + 0.001952479176372*x
	}
	if (-6.111111111111111 <= x) && (x < -5.858585858585858) {
		return 0.002213175892283 + 0.002510534269251*x
	}
	if (-5.858585858585858 <= x) && (x < -5.606060606060606) {
		return 0.002847149192599 + 0.003227047672276*x
	}
	if (-5.606060606060606 <= x) && (x < -5.353535353535353) {
		return 0.003662060220951 + 0.004146331270604*x
	}
	if (-5.353535353535353 <= x) && (x < -5.101010101010100) {
		return 0.004709113572114 + 0.005324643856333*x
	}
	if (-5.101010101010100 <= x) && (x < -4.848484848484848) {
		return 0.006053720606542 + 0.006833121822159*x
	}
	if (-4.848484848484848 <= x) && (x < -4.595959595959595) {
		return 0.007779256420218 + 0.008761236723319*x
	}
	if (-4.595959595959595 <= x) && (x < -4.343434343434343) {
		return 0.009991689936208 + 0.011220739819964*x
	}
	if (-4.343434343434343 <= x) && (x < -4.090909090909090) {
		return 0.012825210092765 + 0.014349933578587*x
	}
	if (-4.090909090909090 <= x) && (x < -3.838383838383837) {
		return 0.016448930693418 + 0.018317901848445*x
	}
	if (-3.838383838383837 <= x) && (x < -3.585858585858585) {
		return 0.021074663483429 + 0.023327991263257*x
	}
	if (-3.585858585858585 <= x) && (x < -3.333333333333332) {
		return 0.026965570368090 + 0.029619316180559*x
	}
	if (-3.333333333333332 <= x) && (x < -3.080808080808080) {
		return 0.034445195666211 + 0.037464314515562*x
	}
	if (-3.080808080808080 <= x) && (x < -2.828282828282827) {
		return 0.043905881149939 + 0.047159410024784*x
	}
	if (-2.828282828282827 <= x) && (x < -2.575757575757574) {
		return 0.055814823075389 + 0.059004748248947*x
	}
	if (-2.575757575757574 <= x) && (x < -2.323232323232322) {
		return 0.070715012027144 + 0.073268110967257*x
	}
	if (-2.323232323232322 <= x) && (x < -2.070707070707069) {
		return 0.089217060251199 + 0.090128211499452*x
	}
	if (-2.070707070707069 <= x) && (x < -1.818181818181817) {
		return 0.111976709619747 + 0.109594876236172*x
	}
	if (-1.818181818181817 <= x) && (x < -1.565656565656564) {
		return 0.139652183416760 + 0.131409752955739*x
	}
	if (-1.565656565656564 <= x) && (x < -1.313131313131311) {
		return 0.172836464466189 + 0.154942402836071*x
	}
	if (-1.313131313131311 <= x) && (x < -1.060606060606059) {
		return 0.211963333869237 + 0.179112062824775*x
	}
	if (-1.060606060606059 <= x) && (x < -0.808080808080806) {
		return 0.257193652764383 + 0.202379608778949*x
	}
	if (-0.808080808080806 <= x) && (x < -0.555555555555554) {
		return 0.308299614577249 + 0.222856231610989*x
	}
	if (-0.555555555555554 <= x) && (x < -0.303030303030301) {
		return 0.364576440741640 + 0.238552092191985*x
	}
	if (-0.303030303030301 <= x) && (x < -0.050505050505048) {
		return 0.424816868062848 + 0.247735827928026*x
	}
	if (-0.050505050505048 <= x) && (x < 0.202020202020204) {
		return 0.487376420569925 + 0.249311936479626*x
	}
	if (0.202020202020204 <= x) && (x < 0.454545454545457) {
		return 0.550333980287003 + 0.243086307235831*x
	}
	if (0.454545454545457 <= x) && (x < 0.707070707070709) {
		return 0.611719411407162 + 0.229815269485667*x
	}
	if (0.707070707070709 <= x) && (x < 0.959595959595962) {
		return 0.669753570368189 + 0.211017834100865*x
	}
	if (0.959595959595962 <= x) && (x < 1.212121212121215) {
		return 0.723040902211842 + 0.188627296436293*x
	}
	if (1.212121212121215 <= x) && (x < 1.464646464646467) {
		return 0.770674057877572 + 0.164610282147726*x
	}
	if (1.464646464646467 <= x) && (x < 1.717171717171720) {
		return 0.812242310945180 + 0.140666589007282*x
	}
	if (1.717171717171720 <= x) && (x < 1.969696969696972) {
		return 0.847764176856110 + 0.118064961264404*x
	}
	if (1.969696969696972 <= x) && (x < 2.222222222222225) {
		return 0.877578561013787 + 0.097609402976238*x
	}
	if (2.222222222222225 <= x) && (x < 2.474747474747478) {
		return 0.902227400149201 + 0.079695212918803*x
	}
	if (2.474747474747478 <= x) && (x < 2.727272727272730) {
		return 0.922352453916575 + 0.064407177172533*x
	}
	if (2.727272727272730 <= x) && (x < 2.979797979797983) {
		return 0.938616892596508 + 0.051623291347034*x
	}
	if (2.979797979797983 <= x) && (x < 3.232323232323235) {
		return 0.951653077280102 + 0.041103313708644*x
	}
	if (3.232323232323235 <= x) && (x < 3.484848484848488) {
		return 0.962032701954002 + 0.032554655741218*x
	}
	if (3.484848484848488 <= x) && (x < 3.737373737373741) {
		return 0.970253574615926 + 0.025676202630627*x
	}
	if (3.737373737373741 <= x) && (x < 3.989898989898993) {
		return 0.976737464169115 + 0.020184291561970*x
	}
	if (3.989898989898993 <= x) && (x < 4.242424242424242) {
		return 0.981834507492845 + 0.015825876995219*x
	}
	if (4.242424242424242 <= x) && (x < 4.494949494949495) {
		return 0.985830941077496 + 0.012383318316638*x
	}
	if (4.494949494949495 <= x) && (x < 4.747474747474747) {
		return 0.988958041662505 + 0.009674168040129*x
	}
	if (4.747474747474747 <= x) && (x < 5.000000000000000) {
		return 0.991401013389811 + 0.007548297316183*x
	}
	return 0.993307149075715
}

// SigmoidPiecewise -- идеи для ускорения:
// 1)бинарный поиск
// 2) массив функция (таких как эта), где индекс массива
// это округленное до целого значение аргумента функции
func SigmoidPiecewise(x float64) float64 {
	if x < -19.747475 {
		return 0.000000002061154
	}
	if (-19.747475 <= x) && (x < -19.494949) {
		return 0.000000003034370
	}
	if (-19.494949 <= x) && (x < -19.242424) {
		return 0.000000003906059
	}
	if (-19.242424 <= x) && (x < -18.989899) {
		return 0.000000005028161
	}
	if (-18.989899 <= x) && (x < -18.737374) {
		return 0.000000006472610
	}
	if (-18.737374 <= x) && (x < -18.484848) {
		return 0.000000008332010
	}
	if (-18.484848 <= x) && (x < -18.232323) {
		return 0.000000010725563
	}
	if (-18.232323 <= x) && (x < -17.979798) {
		return 0.000000013806718
	}
	if (-17.979798 <= x) && (x < -17.727273) {
		return 0.000000017773001
	}
	if (-17.727273 <= x) && (x < -17.474747) {
		return 0.000000022878686
	}
	if (-17.474747 <= x) && (x < -17.222222) {
		return 0.000000029451092
	}
	if (-17.222222 <= x) && (x < -16.969697) {
		return 0.000000037911566
	}
	if (-16.969697 <= x) && (x < -16.717172) {
		return 0.000000048802497
	}
	if (-16.717172 <= x) && (x < -16.464646) {
		return 0.000000062822087
	}
	if (-16.464646 <= x) && (x < -16.212121) {
		return 0.000000080869112
	}
	if (-16.212121 <= x) && (x < -15.959596) {
		return 0.000000104100542
	}
	if (-15.959596 <= x) && (x < -15.707071) {
		return 0.000000134005709
	}
	if (-15.707071 <= x) && (x < -15.454545) {
		return 0.000000172501791
	}
	if (-15.454545 <= x) && (x < -15.202020) {
		return 0.000000222056714
	}
	if (-15.202020 <= x) && (x < -14.949495) {
		return 0.000000285847373
	}
	if (-14.949495 <= x) && (x < -14.696970) {
		return 0.000000367963289
	}
	if (-14.696970 <= x) && (x < -14.444444) {
		return 0.000000473668789
	}
	if (-14.444444 <= x) && (x < -14.191919) {
		return 0.000000609740487
	}
	if (-14.191919 <= x) && (x < -13.939394) {
		return 0.000000784901718
	}
	if (-13.939394 <= x) && (x < -13.686869) {
		return 0.000001010381774
	}
	if (-13.686869 <= x) && (x < -13.434343) {
		return 0.000001300635787
	}
	if (-13.434343 <= x) && (x < -13.181818) {
		return 0.000001674271398
	}
	if (-13.181818 <= x) && (x < -12.929293) {
		return 0.000002155241643
	}
	if (-12.929293 <= x) && (x < -12.676768) {
		return 0.000002774380481
	}
	if (-12.676768 <= x) && (x < -12.424242) {
		return 0.000003571379426
	}
	if (-12.424242 <= x) && (x < -12.171717) {
		return 0.000004597331955
	}
	if (-12.171717 <= x) && (x < -11.919192) {
		return 0.000005918008774
	}
	if (-11.919192 <= x) && (x < -11.666667) {
		return 0.000007618073850
	}
	if (-11.666667 <= x) && (x < -11.414141) {
		return 0.000009806511381
	}
	if (-11.414141 <= x) && (x < -11.161616) {
		return 0.000012623611421
	}
	if (-11.161616 <= x) && (x < -10.909091) {
		return 0.000016249961696
	}
	if (-10.909091 <= x) && (x < -10.656566) {
		return 0.000020918021545
	}
	if (-10.656566 <= x) && (x < -10.404040) {
		return 0.000026927019124
	}
	if (-10.404040 <= x) && (x < -10.151515) {
		return 0.000034662125478
	}
	if (-10.151515 <= x) && (x < -9.898990) {
		return 0.000044619132378
	}
	if (-9.898990 <= x) && (x < -9.646465) {
		return 0.000057436212072
	}
	if (-9.646465 <= x) && (x < -9.393939) {
		return 0.000073934788585
	}
	if (-9.393939 <= x) && (x < -9.141414) {
		return 0.000095172130086
	}
	if (-9.141414 <= x) && (x < -8.888889) {
		return 0.000122509016233
	}
	if (-8.888889 <= x) && (x < -8.636364) {
		return 0.000157696789255
	}
	if (-8.636364 <= x) && (x < -8.383838) {
		return 0.000202989320907
	}
	if (-8.383838 <= x) && (x < -8.131313) {
		return 0.000261286992931
	}
	if (-8.131313 <= x) && (x < -7.878788) {
		return 0.000336321788206
	}
	if (-7.878788 <= x) && (x < -7.626263) {
		return 0.000432895138047
	}
	if (-7.626263 <= x) && (x < -7.373737) {
		return 0.000557183408749
	}
	if (-7.373737 <= x) && (x < -7.121212) {
		return 0.000717130007880
	}
	if (-7.121212 <= x) && (x < -6.868687) {
		return 0.000922948249083
	}
	if (-6.868687 <= x) && (x < -6.616162) {
		return 0.001187765562729
	}
	if (-6.616162 <= x) && (x < -6.363636) {
		return 0.001528447625498
	}
	if (-6.363636 <= x) && (x < -6.111111) {
		return 0.001966650743751
	}
	if (-6.111111 <= x) && (x < -5.858586) {
		return 0.002530162542441
	}
	if (-5.858586 <= x) && (x < -5.606061) {
		return 0.003254604706775
	}
	if (-5.606061 <= x) && (x < -5.353535) {
		return 0.004185586896533
	}
	if (-5.353535 <= x) && (x < -5.101010) {
		return 0.005381417089328
	}
	if (-5.101010 <= x) && (x < -4.848485) {
		return 0.006916488513380
	}
	if (-4.848485 <= x) && (x < -4.595960) {
		return 0.008885473178213
	}
	if (-4.595960 <= x) && (x < -4.343434) {
		return 0.011408450014486
	}
	if (-4.343434 <= x) && (x < -4.090909) {
		return 0.014637070393091
	}
	if (-4.090909 <= x) && (x < -3.838384) {
		return 0.018761797088424
	}
	if (-3.838384 <= x) && (x < -3.585859) {
		return 0.024020116925760
	}
	if (-3.585859 <= x) && (x < -3.333333) {
		return 0.030705383017151
	}
	if (-3.333333 <= x) && (x < -3.080808) {
		return 0.039175538408075
	}
	if (-3.080808 <= x) && (x < -2.828283) {
		return 0.049860352112664
	}
	if (-2.828283 <= x) && (x < -2.575758) {
		return 0.063264917551267
	}
	if (-2.575758 <= x) && (x < -2.323232) {
		return 0.079966036139171
	}
	if (-2.323232 <= x) && (x < -2.070707) {
		return 0.100596884935473
	}
	if (-2.070707 <= x) && (x < -1.818182) {
		return 0.125814446518254
	}
	if (-1.818182 <= x) && (x < -1.565657) {
		return 0.156244323941475
	}
	if (-1.565657 <= x) && (x < -1.313131) {
		return 0.192399899167713
	}
	if (-1.313131 <= x) && (x < -1.060606) {
		return 0.234578493316810
	}
	if (-1.060606 <= x) && (x < -0.808081) {
		return 0.282746633670816
	}
	if (-0.808081 <= x) && (x < -0.555556) {
		return 0.336438027659444
	}
	if (-0.555556 <= x) && (x < -0.303030) {
		return 0.394696654402244
	}
	if (-0.303030 <= x) && (x < -0.050505) {
		return 0.456096644316387
	}
	if (-0.050505 <= x) && (x < 0.202020) {
		return 0.518855200428464
	}
	if (0.202020 <= x) && (x < 0.454545) {
		return 0.581026695847082
	}
	if (0.454545 <= x) && (x < 0.707071) {
		return 0.640736490887675
	}
	if (0.707071 <= x) && (x < 0.959596) {
		return 0.696397236290015
	}
	if (0.959596 <= x) && (x < 1.212121) {
		return 0.746857480044707
	}
	if (1.212121 <= x) && (x < 1.464646) {
		return 0.791458184411376
	}
	if (1.464646 <= x) && (x < 1.717172) {
		return 0.830003243900645
	}
	if (1.717172 <= x) && (x < 1.969697) {
		return 0.862671368934948
	}
	if (1.969697 <= x) && (x < 2.222222) {
		return 0.889902980581494
	}
	if (2.222222 <= x) && (x < 2.474747) {
		return 0.912289927032888
	}
	if (2.474747 <= x) && (x < 2.727273) {
		return 0.930484673256542
	}
	if (2.727273 <= x) && (x < 2.979798) {
		return 0.945134984938305
	}
	if (2.979798 <= x) && (x < 3.232323) {
		return 0.956842889617052
	}
	if (3.232323 <= x) && (x < 3.484848) {
		return 0.966143138284964
	}
	if (3.484848 <= x) && (x < 3.737374) {
		return 0.973495519392520
	}
	if (3.737374 <= x) && (x < 3.989899) {
		return 0.979285985830980
	}
	if (3.989899 <= x) && (x < 4.242424) {
		return 0.983832724285170
	}
	if (4.242424 <= x) && (x < 4.494949) {
		return 0.987394491370000
	}
	if (4.494949 <= x) && (x < 4.747475) {
		return 0.990179527526158
	}
	return 0.992354081232763
}
